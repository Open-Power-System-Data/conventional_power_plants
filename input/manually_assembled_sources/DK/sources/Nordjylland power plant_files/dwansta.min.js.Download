if ("undefined" == typeof Dynamicweb) var Dynamicweb = new Object; "undefined" == typeof Dynamicweb.Analytics && (Dynamicweb.Analytics = new Object), Dynamicweb.Analytics._trackerInstance = null, Dynamicweb.Analytics.Tracker = function () { this._sessionID = "", this._pageID = 0, this._areaID = 0, this._engagement = null }, Dynamicweb.Analytics.Tracker.get_current = function () { return Dynamicweb.Analytics._trackerInstance || (Dynamicweb.Analytics._trackerInstance = new Dynamicweb.Analytics.Tracker), Dynamicweb.Analytics._trackerInstance }, Dynamicweb.Analytics.Tracker.prototype.get_sessionID = function () { return this._sessionID }, Dynamicweb.Analytics.Tracker.prototype.set_sessionID = function (e) { this._sessionID = e }, Dynamicweb.Analytics.Tracker.prototype.get_pageID = function () { return parseInt(this._pageID) || 0 }, Dynamicweb.Analytics.Tracker.prototype.set_pageID = function (e) { this._pageID = e }, Dynamicweb.Analytics.Tracker.prototype.get_areaID = function () { return parseInt(this._areaID) || 0 }, Dynamicweb.Analytics.Tracker.prototype.set_areaID = function (e) { this._areaID = e }, Dynamicweb.Analytics.Tracker.prototype.get_engagement = function () { return this._engagement }, Dynamicweb.Analytics.Tracker.prototype.set_engagement = function (e) { this._engagement = e }, Dynamicweb.Analytics.Tracker.prototype.get_screenWidth = function () { return "undefined" != typeof window.screen.width ? parseInt(window.screen.width) || 0 : 0 }, Dynamicweb.Analytics.Tracker.prototype.get_screenHeight = function () { return "undefined" != typeof window.screen.height ? parseInt(window.screen.height) || 0 : 0 }, Dynamicweb.Analytics.Tracker.prototype.get_colorDepth = function () { return "undefined" != typeof window.screen.colorDepth ? parseInt(window.screen.colorDepth) || 0 : 0 }, Dynamicweb.Analytics.Tracker.prototype.get_referrer = function () { return "undefined" != typeof document.referrer ? document.referrer.toString() : "" }, Dynamicweb.Analytics.Tracker.prototype.get_language = function () { return "undefined" != typeof window.navigator.language ? window.navigator.language : "" }, Dynamicweb.Analytics.Tracker.prototype.add_contentReady = function (e) { var t = null; e && "function" == typeof e && (t = function () { e(this, {}) }, "undefined" != typeof document.addEventListener ? document.addEventListener("DOMContentLoaded", t, !1) : "undefined" != typeof window.attachEvent && window.attachEvent("onload", t)) }, Dynamicweb.Analytics.Tracker.prototype.set_parameters = function (e) { e && ("undefined" != typeof e.sessionID && this.set_sessionID(e.sessionID), "undefined" != typeof e.pageID && this.set_pageID(e.pageID), "undefined" != typeof e.areaID && this.set_areaID(e.areaID), "undefined" != typeof e.engagement && this.set_engagement(e.engagement)) }, Dynamicweb.Analytics.Tracker.prototype.trackVisit = function () { this._send(this._buildTrackerURI()) }, Dynamicweb.Analytics.Tracker.prototype._buildTrackerURI = function () { var e = ""; return e = "/Admin/Public/Stat2.aspx?SessionID=" + encodeURIComponent(this.get_sessionID()), e += "&PageID=" + encodeURIComponent(this.get_pageID().toString()), e += "&AreaID=" + encodeURIComponent(this.get_areaID().toString()), e += "&width=" + encodeURIComponent(this.get_screenWidth().toString()), e += "&height=" + encodeURIComponent(this.get_screenHeight().toString()), e += "&col=" + encodeURIComponent(this.get_colorDepth().toString()), e += "&referrer=" + encodeURIComponent(this.get_referrer()), e += "&async=true", this.get_language() && (e += "&lan=" + encodeURIComponent(this.get_language())), null != this.get_engagement() && (e += "&engagement=" + this.get_engagement()), e }, Dynamicweb.Analytics.Tracker.prototype._send = function (e) { var t = null, n = !1, i = !1, a = "DwTrackScript", r = document.domain || "", c = this._createRequestObject(), o = function (e, t, n) { e.writeAttribute ? e.writeAttribute(t, n) : e.setAttribute && e.setAttribute(t, n) }; if (e && e.length) if (r && r.length && (r = (document.location.protocol + "//" + r + document.location.port + "/").toLowerCase()), c ? (0 == e.indexOf("http://") || 0 == e.indexOf("https://")) && (i = 0 != e.toLowerCase().indexOf(r)) : i = !0, i = !0) { if (t = document.getElementById(a), t || (n = !0, t = document.createElement("script"), o(t, "id", a), o(t, "async", "true"), o(t, "type", "text/javascript")), o(t, "src", e), n) { var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(t, s) } } else c.open("GET", e, !0), c.send(null) }, Dynamicweb.Analytics.Tracker.prototype._createRequestObject = function () { var e = null; if ("undefined" != typeof XMLHttpRequest) e = new XMLHttpRequest; else if ("undefined" != typeof ActiveXObject) { try { e = new ActiveXObject("Microsoft.XMLHTTP") } catch (t) { } if (!e) { try { e = new ActiveXObject("Msxml2.XMLHTTP.6.0") } catch (t) { } if (!e) try { e = new ActiveXObject("Msxml2.XMLHTTP.3.0") } catch (t) { } } } return e }, Dynamicweb.Analytics.Tracker.prototype._isIE = function () { return "undefined" != typeof window.attachEvent || window.navigator.userAgent.toLowerCase().indexOf("msie") >= 0 }, function (e, t) { var n = Dynamicweb.Analytics.Tracker.get_current(); n.set_parameters({ sessionID: e[t].sessionID, pageID: e[t].pageID, areaID: e[t].areaID, engagement: e[t].engagement }), n.trackVisit() }(window, "analytics");